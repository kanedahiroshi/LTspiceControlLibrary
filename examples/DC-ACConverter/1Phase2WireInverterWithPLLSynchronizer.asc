Version 4
SHEET 1 1304 1156
WIRE -1968 -1024 -2208 -1024
WIRE -1712 -1024 -1968 -1024
WIRE -1968 -992 -1968 -1024
WIRE -1888 -992 -1968 -992
WIRE -1712 -992 -1712 -1024
WIRE -1632 -992 -1712 -992
WIRE -1968 -976 -1968 -992
WIRE -1888 -976 -1888 -992
WIRE -1712 -976 -1712 -992
WIRE -1632 -976 -1632 -992
WIRE -1968 -880 -1968 -896
WIRE -1888 -880 -1888 -912
WIRE -1888 -880 -1968 -880
WIRE -1712 -880 -1712 -896
WIRE -1632 -880 -1632 -912
WIRE -1632 -880 -1712 -880
WIRE -1968 -832 -1968 -880
WIRE -1472 -832 -1968 -832
WIRE -1360 -832 -1472 -832
WIRE -1088 -832 -1280 -832
WIRE -1008 -832 -1088 -832
WIRE -1008 -816 -1008 -832
WIRE -2208 -768 -2208 -1024
WIRE -1008 -720 -1008 -736
WIRE -1008 -720 -1056 -720
WIRE -1008 -704 -1008 -720
WIRE -1712 -624 -1712 -880
WIRE -1472 -624 -1712 -624
WIRE -1360 -624 -1472 -624
WIRE -1088 -624 -1280 -624
WIRE -1008 -624 -1088 -624
WIRE -1968 -576 -1968 -832
WIRE -1888 -576 -1968 -576
WIRE -1712 -576 -1712 -624
WIRE -1632 -576 -1712 -576
WIRE -1968 -560 -1968 -576
WIRE -1712 -560 -1712 -576
WIRE -1888 -544 -1888 -576
WIRE -1632 -544 -1632 -576
WIRE -1968 -464 -1968 -480
WIRE -1888 -464 -1888 -480
WIRE -1888 -464 -1968 -464
WIRE -1712 -464 -1712 -480
WIRE -1632 -464 -1632 -480
WIRE -1632 -464 -1712 -464
WIRE -2208 -432 -2208 -688
WIRE -1968 -432 -1968 -464
WIRE -1968 -432 -2208 -432
WIRE -1712 -432 -1712 -464
WIRE -1712 -432 -1968 -432
WIRE -2208 -400 -2208 -432
WIRE -960 -256 -976 -256
WIRE -2192 -240 -2208 -240
WIRE -2128 -240 -2192 -240
WIRE -1904 -240 -2032 -240
WIRE -1856 -240 -1904 -240
WIRE -1712 -240 -1728 -240
WIRE -1472 -240 -1488 -240
WIRE -1328 -240 -1344 -240
WIRE -1312 -240 -1328 -240
WIRE -1200 -240 -1248 -240
WIRE -1136 -240 -1200 -240
WIRE -960 -224 -976 -224
WIRE -1824 -208 -1840 -208
WIRE -1440 -208 -1456 -208
WIRE -1280 -192 -1280 -208
WIRE -1280 -192 -1296 -192
WIRE -960 -192 -976 -192
WIRE -1856 -176 -1920 -176
WIRE -1760 -176 -1760 -208
WIRE -1760 -176 -1792 -176
WIRE -1472 -176 -1488 -176
WIRE -1376 -176 -1376 -208
WIRE -1376 -176 -1408 -176
WIRE -1248 -176 -1248 -240
WIRE -1232 -176 -1248 -176
WIRE -1136 -176 -1168 -176
WIRE -960 -160 -976 -160
WIRE -1824 -144 -1840 -144
WIRE -1440 -144 -1456 -144
WIRE -2208 -128 -2208 -240
WIRE -960 -128 -976 -128
WIRE -2064 -112 -2080 -112
WIRE -1920 -112 -1920 -176
WIRE -1920 -112 -1936 -112
WIRE -1856 -112 -1920 -112
WIRE -1712 -112 -1728 -112
WIRE -1136 -112 -1168 -112
WIRE -1168 -96 -1168 -112
WIRE -960 -96 -976 -96
WIRE -2032 -80 -2048 -80
WIRE -1824 -80 -1840 -80
WIRE -2064 -48 -2080 -48
WIRE -1968 -48 -1968 -80
WIRE -1968 -48 -2000 -48
WIRE -1904 -48 -1904 -240
WIRE -1856 -48 -1904 -48
WIRE -1760 -48 -1760 -80
WIRE -1760 -48 -1792 -48
WIRE -2032 -16 -2048 -16
WIRE -1824 -16 -1840 -16
WIRE -2096 112 -2112 112
WIRE -2016 112 -2096 112
WIRE -1968 112 -2016 112
WIRE -1808 112 -1840 112
WIRE -1024 112 -1056 112
WIRE -1008 112 -1024 112
WIRE -928 112 -944 112
WIRE -848 112 -864 112
WIRE -768 112 -848 112
WIRE -736 112 -768 112
WIRE -1632 128 -1648 128
WIRE -1616 128 -1632 128
WIRE -2144 144 -2176 144
WIRE -1936 144 -1952 144
WIRE -1808 144 -1824 144
WIRE -1056 160 -1056 112
WIRE -848 160 -848 112
WIRE -768 160 -784 160
WIRE -704 160 -704 144
WIRE -704 160 -768 160
WIRE -1968 176 -2032 176
WIRE -1872 176 -1872 144
WIRE -1872 176 -1904 176
WIRE -1776 176 -1792 176
WIRE -1936 208 -1952 208
WIRE -2176 240 -2240 240
WIRE -2032 240 -2032 176
WIRE -2032 240 -2048 240
WIRE -1968 240 -2032 240
WIRE -1744 240 -1840 240
WIRE -1616 240 -1648 240
WIRE -1600 240 -1616 240
WIRE -1520 240 -1536 240
WIRE -1472 240 -1520 240
WIRE -1344 240 -1408 240
WIRE -1248 240 -1344 240
WIRE -2144 272 -2160 272
WIRE -1936 272 -1952 272
WIRE -1520 288 -1520 240
WIRE -1440 288 -1440 272
WIRE -1440 288 -1456 288
WIRE -1344 288 -1344 240
WIRE -1248 288 -1280 288
WIRE -2176 304 -2224 304
WIRE -2080 304 -2080 272
WIRE -2080 304 -2112 304
WIRE -2016 304 -2016 112
WIRE -1968 304 -2016 304
WIRE -1872 304 -1872 272
WIRE -1872 304 -1904 304
WIRE -1024 304 -1056 304
WIRE -1008 304 -1024 304
WIRE -928 304 -944 304
WIRE -848 304 -864 304
WIRE -768 304 -848 304
WIRE -736 304 -768 304
WIRE -608 304 -672 304
WIRE -2144 336 -2160 336
WIRE -1936 336 -1952 336
WIRE -2224 352 -2224 304
WIRE -1632 352 -1632 128
WIRE -1632 352 -2224 352
WIRE -1056 352 -1056 304
WIRE -848 352 -848 304
WIRE -768 352 -784 352
WIRE -704 352 -704 336
WIRE -704 352 -768 352
WIRE -2240 368 -2240 240
WIRE -1616 368 -1616 240
WIRE -1616 368 -2240 368
WIRE -1280 384 -1280 288
WIRE -2064 400 -2080 400
WIRE -2080 416 -2080 400
WIRE -1824 416 -1824 144
WIRE -1280 432 -1280 384
FLAG -2208 -400 0
FLAG -2016 -960 UP
FLAG -2016 -912 0
FLAG -2016 -544 UN
FLAG -2016 -496 0
FLAG -1760 -960 VP
FLAG -1760 -912 0
FLAG -1760 -544 VN
FLAG -1760 -496 0
FLAG -2208 -1024 DC_P
FLAG -960 -256 UP
FLAG -960 -160 VN
FLAG -960 -224 UN
FLAG -960 -192 VP
FLAG -2208 -48 0
FLAG -2192 -240 il1
FLAG -1712 -240 ip
FLAG -1712 -112 iq
FLAG -1024 112 ip*
FLAG -768 112 vp*_p
FLAG -768 160 vp*_i
FLAG -976 144 ip
FLAG -1056 240 0
FLAG -608 112 vp*
FLAG -1024 304 iq*
FLAG -768 304 vq*_p
FLAG -768 352 vq*_i
FLAG -976 336 iq
FLAG -1056 432 0
FLAG -608 304 vq*
FLAG -1488 -240 vp*
FLAG -1488 -176 vq*
FLAG -1296 -192 DC_P
FLAG -1328 -240 v*
FLAG -1088 -832 AC_L1
FLAG -1088 -624 AC_L2
FLAG -1056 -720 AC_N
FLAG -640 144 vp_ac
FLAG -1200 -240 m*
FLAG -2080 496 0
FLAG -2080 400 init
FLAG -2176 112 AC_L1
FLAG -2176 144 AC_L2
FLAG -1168 -96 0
FLAG -1472 -832 INV_L1
FLAG -1472 -624 INV_L2
FLAG -1200 384 cospe
FLAG -1200 432 sinpe
FLAG -1616 128 vp_ac
FLAG -1456 -208 cospe
FLAG -1456 -144 sinpe
FLAG -2080 -112 iq*
FLAG -2080 -48 ip*
FLAG -2048 -80 cospe
FLAG -2048 -16 sinpe
FLAG -1840 -208 cospe
FLAG -1840 -144 sinpe
FLAG -1840 -80 cospe
FLAG -1840 -16 sinpe
FLAG -2096 112 vac
FLAG -2160 272 cospe
FLAG -2160 336 sinpe
FLAG -1952 144 cospe
FLAG -1952 208 sinpe
FLAG -1952 272 cospe
FLAG -1952 336 sinpe
FLAG -1248 240 oe
FLAG -1248 288 pe
FLAG -1616 240 vq_ac
FLAG -1792 176 init
FLAG -1824 496 0
FLAG -960 -128 WP
FLAG -960 -96 WN
SYMBOL voltage -2208 -784 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 350
SYMBOL diode -1904 -912 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL ind -1376 -816 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {Lfilter}
SYMBOL sw -1968 -880 M180
SYMATTR InstName S1
SYMBOL sw -1968 -464 M180
SYMATTR InstName S2
SYMBOL sw -1712 -880 M180
SYMATTR InstName S3
SYMBOL sw -1712 -464 M180
SYMATTR InstName S4
SYMBOL diode -1904 -480 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL diode -1648 -912 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL diode -1648 -480 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL ind -1376 -608 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value {Lfilter}
SYMBOL 3PhaseComplementaryPWM -1136 -304 R0
WINDOW 123 8 265 Left 2
SYMATTR Value2 Tdelay=0 tripdt=100m*Tdead
SYMATTR InstName U1
SYMBOL bv -2208 -144 R0
SYMATTR InstName B1
SYMATTR Value V=I(L1)
SYMBOL sub -992 144 R0
SYMATTR InstName U7
SYMBOL Integral -832 192 R0
SYMATTR Value T=1m
SYMATTR InstName U8
SYMBOL Proportional -912 144 R0
SYMATTR Value K=5
SYMATTR InstName U10
SYMBOL add -720 144 R0
SYMATTR InstName U11
SYMBOL voltage -1056 144 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value PULSE(0 {10*sqrt(2)})
SYMBOL sub -992 336 R0
SYMATTR InstName U12
SYMBOL Integral -832 384 R0
SYMATTR Value T=1m
SYMATTR InstName U13
SYMBOL Proportional -912 336 R0
SYMATTR Value K=5
SYMATTR InstName U14
SYMBOL add -720 336 R0
SYMATTR InstName U15
SYMBOL voltage -1056 336 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V8
SYMATTR Value PULSE(0 {3*sqrt(2)})
SYMBOL LTspiceControlLibrary\\TransferFunctions\\1stOrderLag -2112 -208 R0
SYMATTR Value K=1 T=50u
SYMATTR InstName U27
SYMBOL add -656 144 R0
SYMATTR InstName U29
SYMBOL voltage -1008 -832 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value SINE(0 {Vac/2} {Fac})
SYMBOL voltage -1008 -720 R0
SYMATTR InstName V3
SYMATTR Value SINE(0 {Vac/2} {Fac})
SYMBOL voltage -2080 400 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value PULSE(0 1)
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -2160 144 R0
SYMATTR InstName U30
SYMBOL LTspiceControlLibrary\\Math\\Operands\\neg -1216 -144 R0
SYMATTR InstName U2
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1456 -208 R0
SYMATTR InstName U4
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1456 -144 R0
SYMATTR InstName U6
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -1392 -208 R0
SYMATTR InstName U16
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -2048 -80 R0
SYMATTR InstName U19
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -2048 -16 R0
SYMATTR InstName U20
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -1984 -80 R0
SYMATTR InstName U25
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1840 -208 R0
SYMATTR InstName U28
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1840 -144 R0
SYMATTR InstName U32
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -1776 -80 R0
SYMATTR InstName U33
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1840 -80 R0
SYMATTR InstName U34
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1840 -16 R0
SYMATTR InstName U35
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -1776 -208 R0
SYMATTR InstName U36
SYMBOL LTspiceControlLibrary\\Math\\Operands\\div -1296 -208 R0
SYMATTR InstName U3
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -2160 272 R0
SYMATTR InstName U5
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -2160 336 R0
SYMATTR InstName U9
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -2096 272 R0
SYMATTR InstName U17
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1952 144 R0
SYMATTR InstName U18
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1952 208 R0
SYMATTR InstName U21
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -1888 272 R0
SYMATTR InstName U22
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1952 272 R0
SYMATTR InstName U23
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -1952 336 R0
SYMATTR InstName U24
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -1888 144 R0
SYMATTR InstName U26
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Integral -1328 320 R0
WINDOW 123 0 28 Left 2
SYMATTR Value2 Y0={-pi/2}
SYMATTR InstName U31
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Proportional -1584 272 R0
SYMATTR Value K=0.2
SYMATTR InstName U37
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Integral -1504 320 R0
WINDOW 123 0 28 Left 2
SYMATTR Value2 Y0={2*pi*Fac}
SYMATTR Value T=30m
SYMATTR InstName U38
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -1456 272 R0
SYMATTR InstName U39
SYMBOL LTspiceControlLibrary\\Math\\Functions\\cos -1264 416 R0
SYMATTR InstName U40
SYMBOL LTspiceControlLibrary\\Math\\Functions\\sin -1264 464 R0
SYMATTR InstName U41
SYMBOL LTspiceControlLibrary\\TransferFunctions\\1stOrderLag -1728 160 R0
SYMATTR Value K=1 T=1m
SYMATTR InstName U42
SYMBOL LTspiceControlLibrary\\TransferFunctions\\1stOrderLag -1728 272 R0
SYMATTR Value K=1 T=1m
SYMATTR InstName U43
SYMBOL LTspiceControlLibrary\\Math\\Functions\\if -1792 176 R0
SYMATTR InstName U44
SYMBOL voltage -1824 400 R0
SYMATTR InstName V5
SYMATTR Value {Vac}
TEXT -2216 -1184 Left 2 !.tran 40m
TEXT -2216 -1152 Left 2 !.model SW SW(Ron=1 Roff=1Meg Vt=0.5)\n.model D D(Ron=.1 Roff=1Meg Vfwd=.4)
TEXT -1080 -288 Left 2 ;PWM
TEXT -2208 -288 Left 2 ;sensor
TEXT -1376 -888 Left 2 !.params Lfilter=1m
TEXT -2256 -1224 Left 4 ;Config
TEXT -2296 -1280 Left 5 ;Single-Phase Two-Wire Inverter with PLL Synchronizer
TEXT -2256 -1088 Left 4 ;Circuit
TEXT -2248 -328 Left 4 ;Controller
TEXT -1504 -456 Left 2 ;NOTE:\nIf you want to simulate the dead time of gate signals with accuracy,\nset maximum timestep of transient analysis below the dead time\nor set the parameter 'tripdt' of PWM below the dead time.\nSmaller value brings more accurate but slower simulation.
TEXT -1072 56 Left 2 ;current controller
TEXT -1728 -288 Left 2 ;coordinate transformation
TEXT -2016 56 Left 2 ;PLL synchronizer
TEXT -1088 -888 Left 2 !.params Vac=200*sqrt(2) Fac=50
