Version 4
SHEET 1 1304 1156
WIRE -1984 -304 -2016 -304
WIRE -1968 -304 -1984 -304
WIRE -1888 -304 -1904 -304
WIRE -1760 -304 -1824 -304
WIRE -1680 -304 -1760 -304
WIRE -1648 -304 -1680 -304
WIRE -1536 -304 -1584 -304
WIRE -2016 -256 -2016 -304
WIRE -1760 -256 -1760 -304
WIRE -1680 -256 -1696 -256
WIRE -1616 -256 -1616 -272
WIRE -1616 -256 -1680 -256
WIRE -1296 -240 -1328 -240
WIRE -1280 -240 -1296 -240
WIRE -1200 -240 -1216 -240
WIRE -1200 -224 -1200 -240
WIRE -1184 -224 -1200 -224
WIRE -1168 -224 -1184 -224
WIRE -992 -224 -1040 -224
WIRE -928 -224 -992 -224
WIRE -1536 -208 -1536 -304
WIRE -1504 -208 -1536 -208
WIRE -1488 -208 -1504 -208
WIRE -1408 -208 -1424 -208
WIRE -1328 -208 -1328 -240
WIRE -1328 -208 -1344 -208
WIRE -928 -208 -928 -224
WIRE -1504 -176 -1536 -176
WIRE -1488 -176 -1504 -176
WIRE -1408 -176 -1424 -176
WIRE -1296 -176 -1344 -176
WIRE -1184 -176 -1296 -176
WIRE -1168 -176 -1184 -176
WIRE -1328 -144 -1344 -144
WIRE -1184 -128 -1200 -128
WIRE -1168 -128 -1184 -128
WIRE -1024 -128 -1040 -128
WIRE -928 -128 -1024 -128
WIRE -1328 -112 -1328 -144
WIRE -1296 -112 -1328 -112
WIRE -1280 -112 -1296 -112
WIRE -1200 -112 -1200 -128
WIRE -1200 -112 -1216 -112
WIRE -2608 -96 -2624 -96
WIRE -2592 -96 -2608 -96
WIRE -2512 -96 -2528 -96
WIRE -2384 -96 -2448 -96
WIRE -2320 -96 -2384 -96
WIRE -2288 -96 -2320 -96
WIRE -2208 -96 -2224 -96
WIRE -2192 -96 -2208 -96
WIRE -2032 -96 -2128 -96
WIRE -2016 -96 -2032 -96
WIRE -1888 -96 -1952 -96
WIRE -1760 -96 -1824 -96
WIRE -1680 -96 -1760 -96
WIRE -1648 -96 -1680 -96
WIRE -1536 -96 -1536 -176
WIRE -1536 -96 -1584 -96
WIRE -1456 -80 -1456 -128
WIRE -1328 -80 -1456 -80
WIRE -1024 -64 -1024 -128
WIRE -2624 -48 -2624 -96
WIRE -2384 -48 -2384 -96
WIRE -2368 -48 -2384 -48
WIRE -2288 -48 -2304 -48
WIRE -2256 -48 -2256 -64
WIRE -2256 -48 -2288 -48
WIRE -1760 -48 -1760 -96
WIRE -1680 -48 -1696 -48
WIRE -1616 -48 -1616 -64
WIRE -1616 -48 -1680 -48
WIRE -1936 16 -1936 -272
WIRE -1504 16 -1936 16
WIRE -1488 16 -1504 16
WIRE -1408 16 -1424 16
WIRE -1024 16 -1344 16
WIRE -1008 16 -1024 16
WIRE -1984 48 -1984 -64
WIRE -1504 48 -1984 48
WIRE -1488 48 -1504 48
WIRE -1408 48 -1424 48
WIRE -1168 80 -1344 80
WIRE -1152 80 -1168 80
WIRE -1152 112 -1152 80
WIRE -1008 112 -1008 16
WIRE -1456 128 -1456 96
WIRE -1440 128 -1456 128
WIRE -1376 256 -1376 128
WIRE -1360 256 -1376 256
WIRE -1328 256 -1328 -80
WIRE -1328 256 -1360 256
WIRE -1312 256 -1328 256
WIRE -1232 256 -1248 256
WIRE -1216 256 -1232 256
WIRE -1136 256 -1152 256
WIRE -1008 256 -1136 256
WIRE -1136 336 -1136 256
WIRE -1136 336 -1248 336
WIRE -2560 400 -2560 -64
WIRE -1040 400 -2560 400
WIRE -1008 400 -1008 256
WIRE -1008 400 -1040 400
WIRE -1008 416 -1008 400
FLAG -1008 192 0
FLAG -1152 192 0
FLAG -1024 16 iu
FLAG -1168 80 iw
FLAG -1504 16 id
FLAG -1504 48 iq
FLAG -1984 -304 id*
FLAG -1680 -304 vd*_p
FLAG -1680 -256 vd*_i
FLAG -2016 -176 0
FLAG -2032 -96 iq*
FLAG -1680 -96 vq*_p
FLAG -1680 -48 vq*_i
FLAG -1504 -208 vd*
FLAG -1504 -176 vq*
FLAG -1296 -240 vu*
FLAG -1296 -176 vv*
FLAG -1296 -112 vw*
FLAG -1024 -64 0
FLAG -1008 496 0
FLAG -1040 400 om
FLAG -1232 256 pm
FLAG -1360 256 pe
FLAG -992 -224 Tm
FLAG -1312 336 oe
FLAG -2608 -96 om*
FLAG -2320 -96 tm*_p
FLAG -2288 -48 tm*_i
FLAG -2624 32 0
FLAG -2208 -96 tm*
FLAG -1184 -224 U
FLAG -1184 -176 V
FLAG -1184 -128 W
SYMBOL bv -1008 96 M0
SYMATTR InstName B1
SYMATTR Value V=I(L1)
SYMBOL bv -1152 96 M0
SYMATTR InstName B2
SYMATTR Value V=I(L2)
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\uw-abTransformation -1344 -32 M0
SYMATTR InstName U2
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\xyRotation -1424 -32 M0
SYMATTR InstName U4
SYMBOL LTspiceControlLibrary\\Math\\Operands\\neg -1392 160 M0
SYMATTR InstName U6
SYMBOL sub -1952 -272 R0
SYMATTR InstName U7
SYMBOL Integral -1744 -224 R0
SYMATTR Value T={Tiid}
SYMATTR InstName U8
SYMBOL Proportional -1872 -272 R0
SYMATTR Value K={Kpid}
SYMATTR InstName U10
SYMBOL add -1632 -272 R0
SYMATTR InstName U11
SYMBOL voltage -2016 -272 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value {0*sqrt(3)}
SYMBOL sub -2000 -64 R0
SYMATTR InstName U12
SYMBOL Integral -1744 -16 R0
SYMATTR Value T={Tiiq}
SYMATTR InstName U13
SYMBOL Proportional -1872 -64 R0
SYMATTR Value K={Kpiq}
SYMATTR InstName U14
SYMBOL add -1632 -64 R0
SYMATTR InstName U15
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\xyRotation -1488 -256 R0
SYMATTR InstName U16
SYMBOL LTspiceControlLibrary\\CoordinateTransformations\\ab-uvwTransformation -1408 -256 R0
SYMATTR InstName U17
SYMBOL bv -1008 400 M0
SYMATTR InstName B3
SYMATTR Value V=I(V3)
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Integral -1168 288 M0
SYMATTR InstName U9
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Proportional -1264 288 M0
SYMATTR Value K={Np}
SYMATTR InstName U30
SYMBOL FerriteBead -1248 -240 R270
WINDOW 0 16 0 VTop 2
SYMATTR InstName L1
SYMATTR Value 1n
SYMBOL FerriteBead -1248 -112 R270
WINDOW 0 16 0 VTop 2
SYMATTR InstName L2
SYMATTR Value 1n
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Proportional -1264 368 M0
SYMATTR Value K={Np}
SYMATTR InstName U23
SYMBOL LTspiceControlLibrary\\Motors\\PMSMotor -1040 -176 R0
SYMATTR InstName U5
SYMATTR Value Ra={Ra} Ld={Ld} Lq={Lq} Ke={Ke} Dm={Dm} Jm={Jm} Np={Np}
SYMBOL voltage -928 -224 R0
SYMATTR InstName V3
SYMATTR Value PULSE(0 20m 0.2 0.2)
SYMBOL sub -2576 -64 R0
SYMATTR InstName U1
SYMBOL Integral -2352 -16 R0
SYMATTR InstName U3
SYMATTR Value T={Tiom}
SYMBOL Proportional -2496 -64 R0
SYMATTR Value K={Kpom}
SYMATTR InstName U18
SYMBOL add -2272 -64 R0
SYMATTR InstName U19
SYMBOL voltage -2624 -64 R0
WINDOW 3 24 44 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value 100
SYMATTR InstName V4
SYMBOL Proportional -2176 -64 R0
SYMATTR Value K={1/(Ke*Np)}
SYMATTR InstName U20
TEXT -2616 -624 Left 2 !.tran 0.5 startup
TEXT -1144 -8 Left 2 ;sensor
TEXT -2024 -344 Left 2 ;current controller
TEXT -1552 -344 Left 2 ;coordinate transformation
TEXT -1264 -592 Left 2 !** Anaheim Automation bly171s-15v-8000 parameters\n.params Ra=0.35/2 Ld=0.35m/2 Lq=0.35m/2\n.params Ke=15.0m/sqrt(2)/Np Dm=Jm/0.3 Jm=2.40u Np=4
TEXT -1264 -464 Left 2 !** PWM parameters\n.params Tperiod=100u Tdead=3u
TEXT -1880 -592 Left 2 !** current control parameters\n.params Oci=0.5/Tperiod\n.params wi=0.2\n.params Kpid=Ld*Oci\n.params Tiid=1/(wi*(1-wi)*Oci)\n.params Kpiq=Lq*Oci\n.params Tiiq=1/(wi*(1-wi)*Oci)
TEXT -2408 -584 Left 2 !** speed control parameters\n.params Ocom=0.1*Oci\n.params wom=0.1\n.params Kpom=Jm*Ocom\n.params Tiom=1/(wom*(1-wom)*Ocom)
TEXT -2632 -152 Left 2 ;speed controller
TEXT -2680 -720 Left 5 ;PMSM Vector Control with INV-1TGKIT-A (Circuitless)
TEXT -2640 -672 Left 4 ;Config
TEXT -2656 -376 Left 4 ;Control System
