Version 4
SHEET 1 1304 1156
WIRE -2064 -1008 -2208 -1008
WIRE -1888 -1008 -1904 -1008
WIRE -1696 -1008 -1712 -1008
WIRE -1488 -1008 -1536 -1008
WIRE -1376 -1008 -1488 -1008
WIRE -1888 -960 -1888 -1008
WIRE -1712 -960 -1712 -1008
WIRE -1376 -960 -1376 -1008
WIRE -2208 -944 -2208 -1008
WIRE -2208 -832 -2208 -864
WIRE -1904 -832 -2208 -832
WIRE -1888 -832 -1888 -880
WIRE -1888 -832 -1904 -832
WIRE -1712 -832 -1712 -880
WIRE -1696 -832 -1712 -832
WIRE -1520 -832 -1696 -832
WIRE -1376 -832 -1376 -880
WIRE -1376 -832 -1520 -832
WIRE -928 -832 -1184 -832
WIRE -672 -832 -928 -832
WIRE -2208 -800 -2208 -832
WIRE -1184 -800 -1184 -832
WIRE -1104 -800 -1184 -800
WIRE -928 -800 -928 -832
WIRE -848 -800 -928 -800
WIRE -1184 -784 -1184 -800
WIRE -1104 -784 -1104 -800
WIRE -928 -784 -928 -800
WIRE -848 -784 -848 -800
WIRE -1904 -768 -1904 -832
WIRE -1872 -768 -1904 -768
WIRE -1696 -768 -1696 -832
WIRE -1696 -768 -1728 -768
WIRE -672 -704 -672 -832
WIRE -672 -704 -752 -704
WIRE -1184 -688 -1184 -704
WIRE -1104 -688 -1104 -720
WIRE -1104 -688 -1184 -688
WIRE -928 -688 -928 -704
WIRE -848 -688 -848 -720
WIRE -848 -688 -928 -688
WIRE -752 -688 -752 -704
WIRE -672 -688 -672 -704
WIRE -1488 -672 -1488 -1008
WIRE -1440 -672 -1488 -672
WIRE -1184 -672 -1184 -688
WIRE -1184 -672 -1280 -672
WIRE -1520 -624 -1520 -832
WIRE -928 -624 -928 -688
WIRE -928 -624 -1520 -624
WIRE -1184 -608 -1184 -672
WIRE -1104 -608 -1184 -608
WIRE -928 -608 -928 -624
WIRE -848 -608 -928 -608
WIRE -1184 -592 -1184 -608
WIRE -928 -592 -928 -608
WIRE -752 -592 -752 -608
WIRE -672 -592 -672 -624
WIRE -672 -592 -752 -592
WIRE -1104 -576 -1104 -608
WIRE -848 -576 -848 -608
WIRE -1184 -496 -1184 -512
WIRE -1104 -496 -1104 -512
WIRE -1104 -496 -1184 -496
WIRE -928 -496 -928 -512
WIRE -848 -496 -848 -512
WIRE -848 -496 -928 -496
WIRE -1408 -464 -1440 -464
WIRE -1184 -464 -1184 -496
WIRE -1184 -464 -1264 -464
WIRE -928 -464 -928 -496
WIRE -928 -464 -1184 -464
WIRE -672 -464 -672 -592
WIRE -672 -464 -928 -464
WIRE -1440 -448 -1440 -464
WIRE -848 -288 -864 -288
WIRE -2080 -272 -2096 -272
WIRE -2048 -272 -2080 -272
WIRE -1984 -272 -2048 -272
WIRE -1728 -272 -1776 -272
WIRE -1696 -272 -1728 -272
WIRE -1600 -272 -1632 -272
WIRE -1584 -272 -1600 -272
WIRE -1392 -272 -1520 -272
WIRE -1264 -272 -1328 -272
WIRE -1008 -272 -1136 -272
WIRE -1008 -256 -1008 -272
WIRE -992 -256 -1008 -256
WIRE -864 -256 -864 -288
WIRE -864 -256 -896 -256
WIRE -848 -256 -864 -256
WIRE -2128 -240 -2160 -240
WIRE -1232 -224 -1232 -240
WIRE -1232 -224 -1280 -224
WIRE -992 -208 -1008 -208
WIRE -864 -208 -880 -208
WIRE -848 -208 -864 -208
WIRE -1600 -192 -1600 -272
WIRE -1584 -192 -1600 -192
WIRE -1392 -192 -1520 -192
WIRE -1264 -192 -1328 -192
WIRE -1008 -192 -1008 -208
WIRE -1008 -192 -1136 -192
WIRE -864 -176 -864 -208
WIRE -848 -176 -864 -176
WIRE -2080 -160 -2080 -272
WIRE -2064 -160 -2080 -160
WIRE -1760 -160 -1776 -160
WIRE -1280 -144 -1280 -224
WIRE -1232 -144 -1232 -160
WIRE -1232 -144 -1280 -144
WIRE -2080 -112 -2096 -112
WIRE -1488 -112 -1504 -112
WIRE -1360 -112 -1424 -112
WIRE -1280 -112 -1280 -144
WIRE -1280 -112 -1296 -112
WIRE -2128 -80 -2160 -80
WIRE -2080 16 -2144 16
WIRE -2032 16 -2080 16
WIRE -1888 16 -1904 16
WIRE -1824 16 -1888 16
WIRE -1696 16 -1824 16
WIRE -1552 16 -1568 16
WIRE -1536 16 -1552 16
WIRE -1440 16 -1456 16
WIRE -1376 16 -1440 16
WIRE -1344 16 -1376 16
WIRE -1200 16 -1216 16
WIRE -1136 16 -1200 16
WIRE -1008 16 -1136 16
WIRE -928 16 -944 16
WIRE -832 16 -864 16
WIRE -816 16 -832 16
WIRE -656 16 -704 16
WIRE -624 16 -656 16
WIRE -832 32 -832 16
WIRE -2144 48 -2144 16
WIRE -1552 48 -1552 16
WIRE -1888 64 -1888 16
WIRE -1872 64 -1888 64
WIRE -1712 64 -1744 64
WIRE -1664 64 -1664 48
WIRE -1664 64 -1712 64
WIRE -1312 64 -1312 48
WIRE -1312 64 -1344 64
WIRE -1200 64 -1200 16
WIRE -1184 64 -1200 64
WIRE -1024 64 -1056 64
WIRE -976 64 -976 48
WIRE -976 64 -1024 64
WIRE -896 64 -896 48
WIRE -896 64 -944 64
WIRE -656 64 -656 16
WIRE -656 64 -800 64
WIRE -1440 80 -1440 16
WIRE -1440 80 -1520 80
WIRE -1840 112 -1840 96
WIRE -1552 112 -1840 112
WIRE -1152 112 -1152 96
WIRE -928 112 -1152 112
WIRE -832 112 -832 96
WIRE -832 112 -864 112
WIRE -1600 144 -1600 48
WIRE -1584 144 -1600 144
WIRE -1488 144 -1488 48
WIRE -1488 144 -1520 144
WIRE -944 160 -944 64
WIRE -896 160 -896 144
WIRE -896 160 -944 160
WIRE -2000 192 -2000 48
WIRE -2000 192 -2032 192
WIRE -1600 192 -1600 144
WIRE -1600 192 -2000 192
WIRE -944 192 -944 160
WIRE -944 192 -1600 192
FLAG -2208 -800 0
FLAG -1232 -768 UP
FLAG -1232 -720 0
FLAG -1232 -576 UN
FLAG -1232 -528 0
FLAG -976 -768 VP
FLAG -976 -720 0
FLAG -976 -576 VN
FLAG -976 -528 0
FLAG -2208 -1008 VT_P
FLAG -1376 -1008 VR_P
FLAG -1376 -832 VR_N
FLAG -672 -832 VD_P
FLAG -672 -464 VD_N
FLAG -848 -208 UP
FLAG -848 -256 UN
FLAG -848 -288 VP
FLAG -848 -176 VN
FLAG -2160 -272 VR_P
FLAG -2160 -240 VR_N
FLAG -2160 -112 VD_P
FLAG -2160 -80 VD_N
FLAG -2048 -272 vr
FLAG -2080 -112 vd
FLAG -1728 -272 vr_bpf
FLAG -1664 -240 0
FLAG -1376 16 vd*
FLAG -624 16 ph*
FLAG -1136 16 idp*_p
FLAG -1760 -160 vr_abslpf
FLAG -1504 -112 ph*
FLAG -1344 64 vd
FLAG -1024 64 idp*_i
FLAG -2080 16 vr*
FLAG -1824 16 vd*_p
FLAG -2032 192 vr_abslpf
FLAG -1712 64 vd*_i
FLAG -2144 128 0
FLAG -1440 -448 0
FLAG -1504 48 0
SYMBOL voltage -2208 -960 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 24 96 Invisible 2
SYMATTR Value PULSE({-Vt} {Vt} {0.5/Ft} {0.1m/Ft} {0.1m/Ft} {(0.5-0.1m)/Ft} {1/Ft})
SYMATTR InstName V1
SYMBOL diode -1120 -720 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL sw -1184 -688 M180
SYMATTR InstName S1
SYMBOL sw -1184 -496 M180
SYMATTR InstName S2
SYMBOL sw -928 -688 M180
SYMATTR InstName S3
SYMBOL sw -928 -496 M180
SYMATTR InstName S4
SYMBOL diode -1120 -512 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL diode -864 -720 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL diode -864 -512 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL ind2 -1904 -976 R0
SYMATTR InstName Lm1
SYMATTR Value {Lm1}
SYMATTR Type ind
SYMATTR SpiceLine Rser=0
SYMBOL ind2 -1696 -976 M0
SYMATTR InstName Lm2
SYMATTR Value {Lm2}
SYMATTR Type ind
SYMATTR SpiceLine Rser=0
SYMBOL res -1392 -976 R0
SYMATTR InstName R2
SYMATTR Value {Rl}
SYMBOL res -1456 -656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 2m
SYMBOL ind -1376 -656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Ld3
SYMATTR Value 5.2u
SYMATTR SpiceLine Rser=0
SYMBOL cap -688 -688 R0
SYMATTR InstName Cd4
SYMATTR Value 470u
SYMBOL res -768 -704 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL ind -2000 -992 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Ll1
SYMATTR Value {Ll1}
SYMATTR SpiceLine Rser=0
SYMBOL res -2080 -992 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rs1
SYMATTR Value {Rs1}
SYMBOL ind -1712 -992 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Ll2
SYMATTR Value {Ll2}
SYMATTR SpiceLine Rser=0
SYMBOL res -1632 -992 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rs2
SYMATTR Value {Rs2}
SYMBOL res -1888 -752 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rc12
SYMATTR Value 1G
SYMBOL cap -1792 -752 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cc12
SYMATTR Value 1n
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -2144 -240 R0
SYMATTR InstName U1
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -2144 -80 R0
SYMATTR InstName U2
SYMBOL LTspiceControlLibrary\\TransferFunctions\\2ndOrderBandPassFilter -1968 -240 R0
WINDOW 38 -1 -65 Left 2
SYMATTR Value K=1 w={2*pi*Ft} z=0.05
SYMATTR InstName U3
SYMBOL LTspiceControlLibrary\\Math\\Operands\\nle -1680 -240 R0
SYMATTR InstName U4
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -1328 48 R0
SYMATTR InstName U9
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Proportional -1264 48 R0
SYMATTR InstName U10
SYMATTR Value K=3
SYMBOL LTspiceControlLibrary\\Math\\Functions\\limit -800 48 R0
WINDOW 3 0 0 Left 2
SYMATTR Value y=-z z=0.1*pi
SYMATTR InstName U11
SYMBOL Digital\\srflop -944 -304 R0
SYMATTR InstName A1
SYMBOL LTspiceControlLibrary\\Math\\Operands\\nle -1248 -240 R0
SYMATTR InstName U13
SYMBOL LTspiceControlLibrary\\Math\\Operands\\nle -1248 -160 R0
SYMATTR InstName U14
SYMBOL LTspiceControlLibrary\\PulseModulations\\RisingEdgeDetector -1568 -240 R0
SYMATTR Value Tedge={0.1m/Ft}
SYMATTR InstName U15
SYMBOL LTspiceControlLibrary\\PulseModulations\\FallingEdgeDetector -1568 -160 R0
SYMATTR Value Tedge={0.1m/Ft}
SYMATTR InstName U16
SYMBOL LTspiceControlLibrary\\PulseModulations\\PulseTimer -1376 -240 R0
SYMATTR Value F={Ft}
SYMATTR InstName U5
SYMBOL LTspiceControlLibrary\\PulseModulations\\PulseTimer -1376 -160 R0
SYMATTR Value F={Ft}
SYMATTR InstName U6
SYMBOL LTspiceControlLibrary\\PulseModulations\\RisingEdgeDetector -1184 -240 R0
SYMATTR Value Tedge={0.1m/Ft}
SYMATTR InstName U7
SYMBOL LTspiceControlLibrary\\PulseModulations\\RisingEdgeDetector -1184 -160 R0
SYMATTR Value Tedge={0.1m/Ft}
SYMATTR InstName U8
SYMBOL LTspiceControlLibrary\\Math\\Functions\\abs -2048 -128 R0
SYMATTR InstName U17
SYMBOL LTspiceControlLibrary\\TransferFunctions\\2ndOrderLag -1968 -128 R0
WINDOW 38 0 -66 Left 2
SYMATTR Value K=1 w={2*pi*Ft*0.1} z=1
SYMATTR InstName U18
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Integral -1104 96 R0
SYMATTR Value T=50m
SYMATTR InstName U19
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -992 48 R0
SYMATTR InstName U20
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -1168 96 R0
SYMATTR InstName U21
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -800 48 M90
SYMATTR InstName U22
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -2016 48 R0
SYMATTR InstName U23
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Proportional -1952 48 R0
SYMATTR InstName U24
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Integral -1792 96 R0
SYMATTR Value T=5m
SYMATTR InstName U26
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -1680 48 R0
SYMATTR InstName U27
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -1856 96 R0
SYMATTR InstName U28
SYMBOL LTspiceControlLibrary\\Math\\Operands\\sub -1520 64 M90
SYMATTR InstName U29
SYMBOL voltage -2144 32 R0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res -1424 -448 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rc14
SYMATTR Value 1k
SYMBOL cap -1328 -448 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName Cc14
SYMATTR Value 1p
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Proportional -1472 -80 R0
SYMATTR Value K=1/(2*pi)
SYMATTR InstName U12
SYMBOL LTspiceControlLibrary\\Math\\Operands\\addk -1344 -80 R0
SYMATTR Value k=0.5
SYMATTR InstName U30
SYMBOL LTspiceControlLibrary\\Math\\Operands\\add -1616 48 R0
SYMATTR InstName U31
SYMBOL LTspiceControlLibrary\\Math\\Operands\\div -912 48 R0
SYMATTR InstName U32
SYMBOL LTspiceControlLibrary\\Math\\Operands\\mul -880 144 M0
SYMATTR InstName U33
SYMBOL LTspiceControlLibrary\\Math\\Functions\\mid -1520 48 R0
SYMATTR InstName U25
SYMBOL LTspiceControlLibrary\\TransferFunctions\\Proportional -1568 176 R0
SYMATTR InstName U34
SYMATTR Value K=1.5
TEXT -2216 -1184 Left 2 !.tran 30m startup
TEXT -2216 -1152 Left 2 !.model SW SW(Ron=.1 Roff=1Meg Vt=0.5)\n.model D D(Ron=.1 Roff=1Meg Vfwd=.4)
TEXT -2224 -328 Left 2 ;sensor
TEXT -2256 -1224 Left 4 ;Config
TEXT -2296 -1280 Left 5 ;Wireless Power Transfer through Electromagnetic Induction with Voltage Compensator
TEXT -2256 -1072 Left 4 ;Circuit
TEXT -2264 -392 Left 4 ;Controller
TEXT -1928 -704 Left 2 !.params N1=6 N2=9\n.params Rs1=35.4m Rs2=52.6m\n.params As1=0.1667u As2=0.1444u\n \n.params Acg=As1/5\n.params Ap1=As1-Acg\n.params Ap2=As2-Acg\n.params Ll1=N1*N1*Ap1\n.params Ll2=N2*N2*Ap2\n.params Lm1=N1*N1*Acg\n.params Lm2=N2*N2*Acg
TEXT -1880 -1040 Left 2 !K12 Lm1 Lm2 1
TEXT -2232 -736 Left 2 !.params Vt=20\n.params Ft=100k
TEXT -1672 -1184 Left 2 !.ic I(Lm1)=0\n.ic V(VD_P)={Vt*(N2/N1)*(Acg/As1)/(1+Ll2/(Rs2+Rl)*2*pi*Ft)}\n.ic V(VD_N)=0
TEXT -1248 -40 Left 2 ;vd controller
TEXT -1352 -336 Left 2 ;phase shifter
TEXT -1872 -984 Left 2 ;induction coil
TEXT -1344 -968 Left 2 ;load
TEXT -2032 -912 Left 2 ;transmitter
TEXT -1680 -912 Left 2 ;receiver
TEXT -1872 -40 Left 2 ;vr controller
TEXT -1184 -848 Left 2 ;receiving voltage compensator
TEXT -1768 -336 Left 2 ;zero crossing detector
TEXT -1296 -912 Left 2 !.params Rl=10
TEXT -1568 -16 Left 2 ;variable limitter
